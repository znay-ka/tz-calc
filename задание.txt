Необходимо:
Реализовать калькулятор который будет рассчитывать суммарную задолженность для займа на определенную дату с учетом внесенных платежей.

Условия:
Есть пользователи, и они могут брать займы.
Займы берутся на определенную сумму и каждый день начисляются проценты.  Проценты начисляются на остаток(!) основного долга.
Характеристиками займа (loan) является "сумма" (основной долг - ОД), "дата", "процентная ставка" и "длительность" в днях.
Суммарное количество начисленных процентов не может превышать x3 от отстатка(!) основного долга.
Пользователи могут частично или полностью погашать взятые займы.
Оплат может не быть.
Приоритет погашения - сначала проценты, потом основной долг.

Пример (данные указаны для примера):
Обращение к калькулятору в формате json:
{
	"loan": {
		"base": 1000,
		"date": "2018-07-27 10:20:37",
		"percent": 0.02,
		"duration": 30
	},
	"payments": [
		{ "amount": 5000.00, "date": "2018-07-28 12:35:22" },
		{ "amount": 1433.17, "date": "2018-07-29 23:55:08" },
		{ "amount": 500.00, "date": "2018-08-11 00:05:01" }
	],
	"atDate": "2018-08-06 12:00:00"
}

Ответ:
{ "summ": 100000.00} – не реальный ответ

Указания к реализации: loan заполнен данными всегда. Payments может быть пустым atDate – время запроса данных, заполнено всегда. Валидацию данных делать не нужно.

Требования: PHP 7.*
Дополнительно, плюсом будет:
SOLID,
DRY,
Anemic Domain Model,
Cyclomatic Complexity методов <=5,
Unit tests.
